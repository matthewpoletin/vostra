#include "Display.h"

#include "Bluetooth.h"

unsigned int hours = 4;
unsigned int minutes = 20;
unsigned int seconds = 0;
char time[10];

unsigned int pixelPosition = 0;
const uint8_t rook_bitmap[] U8G_PROGMEM = {
	0x00,			// 00000000 
	0x55,			// 01010101
	0x7f,			// 01111111
	0x3e,			// 00111110
	0x3e,			// 00111110 
	0x3e,			// 00111110
	0x3e,			// 00111110 
	0x7f			// 01111111
};

const uint8_t envelopeBitmap[] U8G_PROGMEM = {
	0xfe, 0x0f, 0x03, 0x18,
	0x05, 0x14, 0x09, 0x12,
	0x11, 0x11, 0xe9, 0x12,
	0x05, 0x14, 0x03, 0x18,
	0xfe, 0x0f
};

const uint8_t bearBitmap[] U8G_PROGMEM = {
   0x80, 0xff, 0x01, 0x00, 0x00, 0x60, 0x00, 0x06, 0x0e, 0x00, 0x10, 0x00,
   0xf8, 0xf3, 0x00, 0x08, 0x00, 0x00, 0x00, 0x01, 0x04, 0x00, 0x00, 0x00,
   0x3e, 0x02, 0x00, 0x00, 0x20, 0x38, 0x02, 0x00, 0x00, 0x00, 0x38, 0x01,
   0x00, 0x00, 0x00, 0x0c, 0x01, 0x00, 0x00, 0x00, 0x06, 0x01, 0x00, 0x00,
   0x80, 0x01, 0x01, 0x00, 0x00, 0x40, 0x00, 0x01, 0x00, 0x00, 0x20, 0x00,
   0x01, 0x04, 0x00, 0x30, 0x00, 0x01, 0x1a, 0x78, 0x18, 0x00, 0x01, 0xf3,
   0x47, 0x0e, 0x00, 0x82, 0x02, 0x38, 0x0e, 0x00, 0x82, 0x02, 0x08, 0x0a,
   0x00, 0x62, 0x0e, 0x18, 0x13, 0x00, 0x32, 0x1c, 0xf0, 0x11, 0x00, 0xe2,
   0x0f, 0xc0, 0x1f, 0x00, 0x7e, 0x00, 0x00, 0x00, 0x00
};

const uint8_t cityBitmap[] U8G_PROGMEM = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x3f, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xc0, 0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0xc0, 0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xfb, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xe0, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0xdf, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xe0, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0xe0, 0xfb, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0x00, 0x00,
   0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x60, 0xdf, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0xe0, 0xff, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0x03, 0x00,
   0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x18, 0x15, 0x03, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0x03, 0x00, 0x10, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x58, 0x55, 0x03, 0x00,
   0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xf8, 0xff, 0x03, 0x00, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x18, 0x15, 0x03, 0x00, 0x7c, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0x03, 0x00,
   0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x58, 0x55, 0x03, 0x00, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0x03, 0x00, 0xff, 0x01, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x15, 0x03, 0x00,
   0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xf8, 0xff, 0x03, 0x00, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x58, 0x55, 0x03, 0x00, 0xff, 0x01, 0x80, 0x01,
   0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xff, 0x03, 0xc0,
   0xff, 0x07, 0x80, 0x01, 0xc0, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00,
   0x18, 0x15, 0x03, 0xc0, 0xaa, 0x06, 0x80, 0x01, 0xe0, 0x08, 0x00, 0x00,
   0x80, 0x00, 0x00, 0x00, 0xf8, 0xff, 0x03, 0xc0, 0xaa, 0x06, 0xc0, 0x03,
   0xf0, 0x18, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x58, 0x55, 0x03, 0xc0,
   0xaa, 0x06, 0xc0, 0x03, 0xf8, 0x38, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00,
   0xf8, 0xff, 0x03, 0xc0, 0xaa, 0x06, 0xf0, 0x0f, 0xfc, 0x78, 0x00, 0x00,
   0xe0, 0x03, 0x00, 0xf8, 0x1f, 0x15, 0x03, 0xc0, 0xaa, 0x06, 0xf0, 0x0f,
   0xfe, 0xf8, 0x00, 0x00, 0xf8, 0x0f, 0x00, 0xf8, 0xff, 0xff, 0x03, 0xc0,
   0xaa, 0x06, 0xf8, 0x1f, 0xfe, 0xf8, 0x01, 0x00, 0xf8, 0x0f, 0x00, 0xf8,
   0x5f, 0x55, 0x03, 0xc0, 0xaa, 0x06, 0xf8, 0x1f, 0x82, 0xf8, 0x03, 0x00,
   0x98, 0x08, 0x00, 0xf8, 0xff, 0xff, 0xff, 0xc0, 0xaa, 0x06, 0xf8, 0x1f,
   0xfe, 0xf8, 0x03, 0x00, 0xf8, 0x0f, 0x00, 0xf8, 0x1f, 0x15, 0xab, 0xc0,
   0xaa, 0x26, 0xf8, 0x1f, 0xfe, 0xf8, 0x03, 0x00, 0xf8, 0x0f, 0x80, 0xf8,
   0xff, 0xff, 0xff, 0xc0, 0xaa, 0x26, 0xf8, 0x1f, 0xfe, 0xa8, 0x02, 0x00,
   0x88, 0x08, 0x80, 0xf9, 0x5f, 0x55, 0xab, 0xc0, 0xaa, 0x26, 0xf8, 0x1f,
   0x82, 0xa8, 0x02, 0x00, 0xf8, 0x0f, 0x80, 0xff, 0xff, 0xff, 0xff, 0xc0,
   0xaa, 0x76, 0xf8, 0x1f, 0xfe, 0xa8, 0x02, 0x00, 0xf8, 0x0f, 0x80, 0xff,
   0x1f, 0x15, 0xab, 0xc0, 0xaa, 0xfe, 0xf8, 0x1f, 0xfe, 0xa8, 0x02, 0x00,
   0x88, 0xe8, 0x9f, 0xfa, 0xff, 0xff, 0xff, 0xc0, 0xaa, 0xfe, 0xf8, 0x1f,
   0xfe, 0xa8, 0x32, 0x00, 0xff, 0x6f, 0x9b, 0xff, 0x5f, 0x55, 0xab, 0xc0,
   0xaa, 0xae, 0xf9, 0x1f, 0x82, 0xa8, 0x32, 0x00, 0xff, 0x6f, 0x9b, 0xff,
   0xff, 0xff, 0xff, 0xc0, 0xaa, 0xfe, 0xfb, 0x1f, 0xfe, 0xa8, 0x32, 0x00,
   0x8b, 0x68, 0x9b, 0xfa, 0x1f, 0x15, 0xab, 0xc8, 0xaa, 0xae, 0xff, 0x1f,
   0xfe, 0xa8, 0x32, 0x00, 0xff, 0x7f, 0x9b, 0xff, 0xff, 0xff, 0xff, 0xdc,
   0xaa, 0xfe, 0xf9, 0xff, 0xff, 0xa8, 0x7a, 0x00, 0xfb, 0x7f, 0x9b, 0xff,
   0x5f, 0x55, 0xab, 0xfe, 0xaa, 0xae, 0xff, 0xbf, 0x82, 0xa8, 0x4a, 0x00,
   0x8f, 0x68, 0xfb, 0xfa, 0xff, 0xff, 0xff, 0xe3, 0xaa, 0xfe, 0xf9, 0xff,
   0xff, 0xaf, 0x7a, 0x00, 0xfb, 0x7f, 0xfb, 0xff, 0x1f, 0x15, 0xab, 0xff,
   0xaa, 0xae, 0xff, 0xbf, 0xfe, 0xaa, 0x4a, 0x00, 0xff, 0x6f, 0xfb, 0xff,
   0xff, 0xff, 0xff, 0xc1, 0xaa, 0xfe, 0xf9, 0xff, 0xff, 0xaf, 0xfe, 0x00,
   0x8b, 0x78, 0xfb, 0xfa, 0x5f, 0x55, 0xab, 0xff, 0xaa, 0xae, 0xff, 0xbf,
   0x82, 0xad, 0xce, 0x00, 0xff, 0x6f, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xc1,
   0xaa, 0xfe, 0xf9, 0xff, 0xff, 0xaf, 0xfe, 0x00, 0xfb, 0x7f, 0xfb, 0xff,
   0x1f, 0x15, 0xab, 0xff, 0xaa, 0xae, 0xff, 0xbf, 0xfe, 0xaa, 0xce, 0x00,
   0x8f, 0x68, 0xfb, 0xfa, 0xff, 0xff, 0xff, 0xc1, 0xaa, 0xfe, 0xf9, 0xff,
   0xff, 0xaf, 0xfe, 0xe0, 0xfb, 0x7f, 0xfb, 0xff, 0x5f, 0x55, 0xab, 0xff,
   0xff, 0xaf, 0xff, 0xbf, 0x82, 0xad, 0xce, 0xef, 0xff, 0x6f, 0xfb, 0xff,
   0xff, 0xff, 0xff, 0xc1, 0xff, 0xff, 0xf9, 0xff, 0xff, 0xaf, 0xfe, 0xea,
   0x8b, 0x78, 0xfb, 0xfa, 0x1f, 0x15, 0xab, 0xff, 0xff, 0xaf, 0xff, 0xbf,
   0xfe, 0xaa, 0xce, 0xed, 0xff, 0x7f, 0xfb, 0xff, 0xff, 0xff, 0xff, 0xc1,
   0xff, 0xff, 0xf9, 0xff, 0xff, 0xff, 0xff, 0xfa, 0xfb, 0x7f, 0xfb, 0xff,
   0xff, 0xff, 0xab, 0xff, 0xff, 0xaf, 0xff, 0xbf, 0x82, 0xfd, 0xcf, 0xfd,
   0x8f, 0x78, 0xfb, 0xfa, 0xff, 0xff, 0xff, 0xc1, 0xff, 0xff, 0xff, 0xff,
   0xff, 0xff, 0xff, 0xfa, 0xff, 0x7f, 0xfb, 0xff, 0xff, 0xff, 0xab, 0xff,
   0xff, 0xff, 0xff, 0xbf, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
   0xff, 0xff, 0xff, 0xff
};
   
void DisplayInit(void)
{
	// Either use normal display driver (slower, small memory requirement:
	u8g_InitComFn(&u8g, &u8g_dev_ssd1306_128x64_i2c, u8g_com_hw_i2c_fn);
	// or the 2x driver (faster, but more memory requirement.)
	//u8g_InitComFn(&u8g, &u8g_dev_ssd1306_128x64_2x_i2c, u8g_com_hw_i2c_fn);  
	// See the bottom of file: u8g_dev_ssd1306_128x64.c
}

void DisplayLogo(void)
{
	u8g_FirstPage(&u8g);  
	do
	{
		u8g_DrawXBM(&u8g, 0, 0, 128, 64, cityBitmap);
		u8g_SetFont(&u8g, u8g_font_freedoomr10r);
		u8g_DrawStr(&u8g, 79, 20, "VOSTRA");

//		u8g_DrawXBM(&u8g, 0, 0, 38, 21, bearBitmap);
//		u8g_SetFont(&u8g, u8g_font_freedoomr10r);
//		u8g_DrawStr(&u8g, 40, 20, "VOSTRA");
	} while ( u8g_NextPage(&u8g) ); 
}

void DisplayDraw(void)
{
	u8g_FirstPage(&u8g);  
	do
	{
		seconds++;
		sprintf(time, "%02d:%02d:%02d", hours, minutes, seconds);
		u8g_SetFont(&u8g, u8g_font_freedoomr10r);
		u8g_DrawStr(&u8g, 40, 20, time);
		if(seconds == 60) { seconds = 0; minutes++; }
		if(minutes == 60) { minutes = 0; hours++; }
		if(hours == 24) { hours = 0; }
		
		u8g_DrawBitmapP(&u8g, 0, 0, 1, 8, rook_bitmap);
		
		u8g_DrawXBM(&u8g, 0, 20, 13, 9, envelopeBitmap);
		
		u8g_SetFont(&u8g, u8g_font_freedoomr10r);
		u8g_DrawStr(&u8g, 40, 60, RxBuffer);
		
//		if(2 <= hours || hours <= 4) u8g_SleepOff(&u8g);
//		else u8g_SleepOn(&u8g);
		
//		u8g_DrawPixel(&u8g, pixelPosition, 25);
//		pixelPosition++;
		
//		u8g_DrawBox(&u8g, 0, 40, 127, 64);
//			u8g_DrawBitmapP(&u8g,0,10,13,19,(const uint8_t *)&img);
//			u8g_DrawFrame(&u8g, 0, 29, 127, 15);  
//			u8g.font = u8g_font_courR08;//u8g_font_profont22;  
//			u8g_DrawStr(&u8g, 10, 40, "Research Engeneer");
	} while ( u8g_NextPage(&u8g) ); 
	/* refresh screen after some delay */
	//delay_micro_seconds(10000);
}
